static char *read_line(t_gnl_data *data) {
    char *line = NULL;
    int line_len = 0;
    char *newline_ptr = NULL;

    while (1) {
        if (data->buffer_index >= data->bytes_read) {
            return line;  // Return the line or NULL if buffer is exhausted
        }

        newline_ptr = memchr(data->buffer + data->buffer_index, '\n', data->bytes_read - data->buffer_index);
        int chunk_len = (newline_ptr) ? (newline_ptr - (data->buffer + data->buffer_index) + 1) : (data->bytes_read - data->buffer_index);

        line = allocate_and_copy(line, line_len, chunk_len);
        if (!line) {
            return NULL;  // Memory allocation error
        }
        memcpy(line + line_len, data->buffer + data->buffer_index, chunk_len);
        line_len += chunk_len;
        data->buffer_index += chunk_len;

        if (newline_ptr) {
            return line;  // Return the line if a newline is found
        }
    }
}